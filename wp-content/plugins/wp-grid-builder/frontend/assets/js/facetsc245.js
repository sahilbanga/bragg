/*!
* WP Grid Builder Plugin
*
* @package   WP Grid Builder
* @author    Loïc Blascos
* @link      https://www.wpgridbuilder.com
* @copyright 2019-2023 Loïc Blascos
*
*/
!function(){var e={594:function(){var e="undefined"!=typeof Map&&new Map;window.WP_Grid_Builder.on("init",(function(t){t.facets.on("render",(function(t){var n=this.facet,r=n.type,i=n.focused;if(function(t,n,r){var i=t.querySelector("button.wpgb-toggle-hidden");if(!i)return;var a=i.previousElementSibling,s="wpgb-".concat(Math.random().toString(36).substr(2,9));i.setAttribute("aria-controls",s),a.id=s,function(t,n,r){if(e.has(t))e.get(t)&&(n.setAttribute("aria-expanded",!1),r.toggleHidden(!1,r.facet));else{t.querySelector('li[hidden] [role="button"][aria-pressed="true"] input[type="hidden"]')&&r.toggleHidden(!1,r.facet)}}(t,i,r),n&&n.classList.contains("wpgb-toggle-hidden")&&i.focus({preventScroll:!0})}(t,i,this),i&&t)switch(r){case"load_more":!function(e){var t=e.querySelector(".wpgb-load-more");requestAnimationFrame((function(){return t&&t.focus({preventScroll:!0})}))}(t);break;case"pagination":!function(e,t){var n=parseInt(t.getAttribute("data-page")||0,10);if(n){var r=t.textContent;e.querySelectorAll('a[data-page="'.concat(n-1,'"], a[data-page="').concat(n,'"], a[data-page="').concat(n+1,'"]')).forEach((function(e){return r===e.textContent&&e.focus({preventScroll:!0})}))}}(t,i);break;case"sort":case"select":case"per_page":!function(e,t){if("SELECT"!==t.tagName||t.classList.contains("wpgb-combobox"))return;var n=e.querySelector("select:not(.wpgb-combobox)");n&&n.focus({preventScroll:!0})}(t,i);break;case"selection":case"number":case"range":case"date":case"search":case"autocomplete":case"geolocation":case"map":case"result_count":case"reset":case"apply":break;default:!function(e,t){var n=t.facet.focused.querySelector("input");if(n){var r=n.value,i=e.querySelector('[role="button"] input[type="hidden"][value="'.concat(CSS.escape(r),'"]')),a=i&&i.closest('[role="button"]');t.facet.settings.treeview||a&&a.focus({preventScroll:!0})}}(t,this)}})),t.facets.on("toggle",(function(t,n){return e.set(t.holder,n)}))}))},378:function(){function e(e){if("reset"===this.facet.type){var n=this.facet.html&&e.querySelector("button.wpgb-reset");n&&t.call(this,n)}}function t(e){var t=this,n=this.facet.settings.reset_facet||[];requestAnimationFrame((function(){setTimeout((function(){var r=Object.keys(t.getParams()),i=r.length;Array.isArray(n)&&n.length&&(i=n.filter((function(e){return t.facets[e]&&t.facets[e][0]&&r.includes(t.facets[e][0].slug)})).length),e.disabled=!i}))}))}window.WP_Grid_Builder.on("init",(function(t){t.facets.on("render",e)}))},417:function(){var e=document.createElement("div"),t="wpgb-content",n=new RegExp("^".concat(t),"i");window.addEventListener("wpgb.loaded",(function(){wpgb_settings&&wpgb_settings.shadowGrids&&wpgb_settings.shadowGrids.forEach((function(r){var i={id:r,isShadow:!0},a=e.cloneNode();/^\d+$/.test(r)||(i.isTemplate=!0),n.test(r)&&(a=function(e,n){var r=".".concat(n.id,":not([hidden])"),i=document.querySelector("".concat(r,":not([data-instance])"));if(r+=' > *:not([class*="'.concat(t,'"])'),i){var a=i.querySelector('[class*="'.concat(t,'"][hidden]'));a&&a.parentElement.removeChild(a)}else{if(r=".".concat(n.id),(i=document.querySelector("".concat(r,":not([data-instance])")))&&i.parentElement){var s=i;i=i.parentElement,s.parentElement.removeChild(s)}r+=' ~ *:not([class*="'.concat(t,'"])')}i&&(delete n.isShadow,i.querySelector(".wpgb-facet")&&console.error("Facets should not be placed in '".concat(n.id,"' element.")));return n.customContent=!0,n.itemSelector=r,n.ajaxUrl=wpgb_settings.permalink+"?"+wpgb_settings.ajaxUrl.split(/[?#]/)[1],i||e}(a,i),i.id=r.trim()),WP_Grid_Builder.instantiate(a,i).init()}))}))},748:function(e,t,n){(function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),r=n.length,i=-1,a="",s=n.charCodeAt(0);++i<r;)0!=(t=n.charCodeAt(i))?a+=t>=1&&t<=31||127==t||0==i&&t>=48&&t<=57||1==i&&t>=48&&t<=57&&45==s?"\\"+t.toString(16)+" ":0==i&&1==r&&45==t||!(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?"\\"+n.charAt(i):n.charAt(i):a+="�";return a};e.CSS||(e.CSS={}),e.CSS.escape=t})(void 0!==n.g?n.g:this)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=function(e){var t;"function"==typeof Event?t=new CustomEvent(e):(t=document.createEvent("CustomEvent")).initEvent(e,!0,!0),window.dispatchEvent(t)};n(748);function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var o,c=[],u=!!((o=document.createElement("link").relList)&&o.supports&&o.supports("preload")),l=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t(this,e),n&&(this.library=n,this.callback=r,this.getScript(),this.script))return this.isLoaded()?this.callback&&this.callback():void(this.isLoading()?this.bindEvents(c[this.script.handle].element):this.loadScript())}return s(e,[{key:"getScript",value:function(){var e=this;this.script=wpgb_settings.vendors.filter((function(t){return t.handle===e.library})),this.script=this.script.shift()}},{key:"isLoaded",value:function(){return c[this.library]&&c[this.library].loaded}},{key:"isLoading",value:function(){return c[this.library]&&c[this.library].loading}},{key:"loadScript",value:function(){var e=document.createElement("css"===this.script.type?"link":"script"),t=this.script.version?"?v=".concat(this.script.version):"",n=this.script.source+t;this.bindEvents(e),"css"===this.script.type?(e.rel=u?"preload":"stylesheet",u&&(e.as="style"),e.href=n):e.src=n,document.head.appendChild(e),c[this.script.handle]={loading:!0,element:e}}},{key:"onLoad",value:function(){var e=c[this.script.handle];"preload"===e.element.rel&&(e.element.rel="stylesheet",e.element.removeAttribute("as")),e.loaded=!0,this.callback&&this.callback()}},{key:"onError",value:function(){c[this.script.handle].error=!0}},{key:"bindEvents",value:function(e){var t=this;e.addEventListener("load",(function(){return t.onLoad()})),e.addEventListener("error",(function(){return t.onerror()}))}}]),e}();function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function b(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(){function e(){t(this,e),this.listeners=new Map}return s(e,[{key:"canListen",value:function(e,t){return!("function"!=typeof t||!e)||(!("object"!==r(t)||!t[e])||(console.error('Invalid listener for event name: "'.concat(e,'"')),!1))}},{key:"exists",value:function(e,t){if(this.listeners.has(e))return this.listeners.get(e).find((function(e){return e.listener===t}))}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.canListen(e,t)?(this.listeners.has(e)||this.listeners.set(e,[]),this.exists(e,t)||this.listeners.get(e).push({listener:t,once:n}),this):this}},{key:"once",value:function(e,t){return this.on(e,t,!0)}},{key:"off",value:function(e,t){var n=this.listeners.get(e)||[],r=n.findIndex((function(e){return e.listener===t}));return r>-1&&n.splice(r,1),n.length<1&&this.listeners.delete(e),this}},{key:"offAll",value:function(){return this.listeners.clear(),this}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return b(this.listeners.get(e)||[]).forEach((function(n){var a,s;(n.once&&t.off(e,n.listener),"object"===r(n.listener))?(a=n.listener[e]).apply.apply(a,[n.listener].concat(i)):(s=n.listener).apply.apply(s,[t].concat(i))})),this}}]),e}(),S=function(e){d(r,e);var n=v(r);function r(){var e;return t(this,r),(e=n.call(this)).vendors={},e.instances={},e}return s(r,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.instances,n=[];if(!Object.keys(t).length)return[];for(var r in t)(t[r].id||"").toString()===e.toString()&&n.push(t[r]);return n}},{key:"instance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object.keys(this.instances).length&&this.instances[e]?this.instances[e]:{}}}]),r}(w),_=Math.sign&&Array.from&&Array.prototype.fill&&Array.prototype.find&&Array.prototype.findIndex&&Array.prototype.includes&&Element.prototype.matches&&Element.prototype.closest&&NodeList.prototype.forEach&&window.Map&&window.URLSearchParams;function P(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}window.WP_Grid_Builder||(window.WP_Grid_Builder=_?new S:{get:function(){return[]},instance:function(){return[]},instances:function(){return[]},instantiate:function(){return[]},on:function(){return null},off:function(){return null},once:function(){return null},offAll:function(){return null},emit:function(){return null},vendors:{},unsupported:!0});var x={},A={},q={},L=0,O=function(e){d(r,e);var n=v(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,r),i=n.call(this),e?e.instance?g(i,q[e.instance]):(i.element=e,i.options=E(E({},A),a),i.htmlInit(),i.id=i.options.id,i.setInstance(),i.intiFacets(),i):g(i)}return s(r,[{key:"setInstance",value:function(){this.instance=++L,this.element.instance=this.instance,q[this.instance]=this}},{key:"htmlInit",value:function(){var e=this.element.getAttribute("data-options");e&&(e=JSON.parse(e),this.options=E(E({},this.options),e),this.element.removeAttribute("data-options"))}},{key:"intiFacets",value:function(){this.facets=WP_Grid_Builder.Facets(this.element,this.options)}},{key:"init",value:function(){this.element&&(this.element.classList.add("wpgb-enabled"),this.element.setAttribute("data-instance",this.instance),window.WP_Grid_Builder.emit("init",[this]),this.facets&&this.facets.init())}},{key:"destroy",value:function(){var e=Object.getOwnPropertyNames(this);if(this.element){this.facets.destroy(),this.element.classList.remove("wpgb-enabled"),this.element.setAttribute("data-options",JSON.stringify(this.options)),delete WP_Grid_Builder.instances[this.instance],delete this.element.instance,delete x[this.instance],delete q[this.instance];for(var t=0;t<e.length;t++)delete this[e[t]]}}}]),r}(w);function C(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}var j=function(e){d(r,e);var n=v(r);function r(){var e,i,a,s;t(this,r);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return P(p(e=n.call.apply(n,[this].concat(c))),"onscroll",(i=function(){return e.check()},a=100,s=0,function(){var e=(new Date).getTime();if(!(e-s<a))return s=e,i.apply(void 0,arguments)})),e}return s(r,[{key:"canObserve",value:function(){return"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}},{key:"observe",value:function(){this.canObserve()?this.loader&&this.observer().observe(this.loader):(window.addEventListener("scroll",this),this.check())}},{key:"unObserve",value:function(){if(this.intersection)return this.intersection.disconnect(),void delete this.intersection;window.removeEventListener("scroll",this)}},{key:"observer",value:function(){var e=this;return this.intersection=new IntersectionObserver((function(t,n){t.forEach((function(t){t.isIntersecting&&e.loader&&e.loader.click()}))}),{rootMargin:"600px"}),this.intersection}},{key:"check",value:function(){this.loader&&this.inView()&&this.loader&&this.loader.click()}},{key:"inView",value:function(e){var t=this.loader.getBoundingClientRect(),n=t.top,r=t.bottom,i=window.innerHeight;return n>=600&&n<=i||r>=0&&r<=i}}]),r}(w),D=function(e){d(i,e);var n=v(i);function i(){return t(this,i),n.apply(this,arguments)}return s(i,[{key:"bindEvents",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e=e?"addEventListener":"removeEventListener",this.history&&window[e]("popstate",this),document[e]("click",this,!0),document[e]("change",this,!1),document[e]("keydown",this,!1),document[e]("mousedown",this,!1)}},{key:"handleEvent",value:function(e){var t="on"+e.type;this[t]&&this[t](e)}},{key:"isFacet",value:function(e){var t=this,n='.wpgb-facet[data-grid="'.concat(CSS.escape(this.options.id),'"]'),r=e&&e.closest(n),i=r&&r.closest(".wp-grid-builder");if(!r)return!1;if(i&&i!==this.element)return!1;var a=this.getFacet(r.getAttribute("data-facet"));return a&&a.forEach((function(e){e.holder!==r||(t.facet=e)})),!!this.facet}},{key:"onpopstate",value:function(e){var t=e.state;t&&t.WP_Grid_Builder===this.options.id&&(delete this.loadMoreSlug,delete this.loadPageSlug,this.getURLParams(),this.fetch())}},{key:"onclick",value:function(e){if(this.isFacet(e.target)){switch(this.facet.type){case"pagination":this.handlePagination(e);break;case"load_more":this.handleLoadMore(e);break;case"reset":this.handleReset(e)}e.target.closest(".wpgb-toggle-hidden")&&this.toggleHidden(e,this.facet),this.toggleButton(e),delete this.facet}}},{key:"onmousedown",value:function(e){this.isFacet(e.target)&&(e.target.closest('[class^="wpgb"][role="button"][tabindex="-1"]')&&e.preventDefault(),delete this.facet)}},{key:"onchange",value:function(e){if(this.isFacet(e.target)&&"type"in this.facet){var t,n=e.target,r=n.value,i=n.name.replace("[]",""),a=this.getInputType(e.target,this.facet);t="select-multiple"===a?this.getSelectValues(e):this.getValues(e,r),"checkbox"===a?this.diffParams(i,t):this.setParams(i,t),this.emit("change",[i,this.getParams(i)]),this.refresh(),delete this.facet}}},{key:"onkeydown",value:function(e){var t=e.keyCode;[13,32].includes(t)&&this.isFacet(e.target)&&(this.toggleButton(e),delete this.facet)}},{key:"handlePagination",value:function(e){var t=e.target.getAttribute("data-page");if(t){var n=e.target.closest("ul"),r=n&&n.querySelector("[aria-current]");r&&r.removeAttribute("aria-current"),e.target.setAttribute("aria-current",!0),e.preventDefault(),this.loadPage(t),this.scrollToTop()}}},{key:"scrollToTop",value:function(){var e=this.facet.settings;if(e.scroll_to_top){var t=this.element.querySelector(".wpgb-layout")||this.element,n=t.getBoundingClientRect().top+window.pageYOffset+e.scroll_to_top_offset;t.tabIndex=-1,t.focus({preventScroll:!0}),"scrollBehavior"in document.documentElement.style?window.scrollTo({top:n,behavior:"smooth"}):document.documentElement.scrollTop=n}}},{key:"handleLoadMore",value:function(e){var t=this.facet.settings;!t||t.offset+t.number<1||e.target.closest(".wpgb-load-more")&&this.loadMore()}},{key:"handleReset",value:function(e){var t=this,n=this.facet.settings,i=n&&n.reset_facet;e.target.closest(".wpgb-reset")&&(i=(i=i.length&&"object"!==r(i)?[i]:i).length&&i.map((function(e){return(e=t.getFacet(parseInt(e,10)))&&e[0]&&e[0].slug})),this.reset(i))}},{key:"toggleButton",value:function(e){var t,n=e.target,r=n.closest('[role="button"]');if(r){var i="true"===r.getAttribute("aria-pressed"),a=r.querySelector("input");if(a&&"-1"!==r.getAttribute("tabindex")){e.preventDefault(),e.stopImmediatePropagation();var s=a.value,o=this.getInputType(a,this.facet);if(!i||"radio"!==o||""!==s){var c,u=n.closest(".wpgb-facet");if("radio"===o){var l=u.querySelectorAll('[role="button"][aria-pressed="true"]');if(l.forEach((function(e){return e.setAttribute("aria-pressed",!1)})),i&&l){var f=u.querySelector('[role="button"] input[type="hidden"][value=""]');f&&f.parentElement.setAttribute("aria-pressed",!0)}}else{if(u.querySelectorAll('[role="button"][aria-pressed="true"] input[type="hidden"][value=""]').forEach((function(e){return e.parentElement.setAttribute("aria-pressed",!1)})),i&&1===u.querySelectorAll('[role="button"][aria-pressed="true"]').length){var d=u.querySelector('[role="button"] input[type="hidden"][value=""]');d&&d.parentElement.setAttribute("aria-pressed",!0)}}if(r.setAttribute("aria-pressed",(!i).toString()),a.checked=!i,"checkbox"===o&&null!==(t=this.facet)&&void 0!==t&&null!==(t=t.settings)&&void 0!==t&&t.treeview)null===(c=r.closest('[role="treeitem"]'))||void 0===c||c.setAttribute("aria-selected",(!i).toString());i&&"radio"===o&&(a.value=""),"function"==typeof Event?e=new Event("change",{bubbles:!0}):(e=document.createEvent("Event")).initEvent("change",!0,!0),a.dispatchEvent(e),a.value=s}}}}},{key:"toggleHidden",value:function(e,t){var n=t.holder,r=t.settings,i=n.querySelector("ul"),a=i&&n.querySelector(".wpgb-toggle-hidden"),s=a&&"true"===a.getAttribute("aria-expanded"),o=i&&s&&i.querySelectorAll("[hidden]");i&&(e&&e.stopImmediatePropagation(),a.textContent=s?r.show_more_label.replace("[number]",o.length):r.show_less_label,a.setAttribute("aria-expanded",!s),i.classList.toggle("wpgb-expanded"),this.emit("toggle",[t,!s]))}},{key:"getValues",value:function(e,t){var n=[];return""===t?n:(n="range"===this.facet.type?this.getRange(e):this.getInput(t)).map(String).filter((function(e,t,n){return n.indexOf(e)===t}))}},{key:"getSelectValues",value:function(e){return b(e.target.closest("select").options).filter((function(e){return e.selected})).map((function(e){return e.value}))}},{key:"getInput",value:function(e){var t=[];try{e=JSON.parse(e)}catch(e){}return Array.isArray(e)?t=e:t.push(e),t}},{key:"getInputType",value:function(e,t){var n=e.type;return"select-multiple"===n||("checkbox"===t.type||"selection"===t.type||t.settings&&t.settings.multiple&&e.value?n="checkbox":"hidden"===n&&(n="radio")),n}},{key:"getRange",value:function(e){var t=b(e.target.closest(".wpgb-facet").querySelectorAll('input[type="range"]')),n=t[0]?[t[0].min,t[0].max]:[],r=t.map((function(e){return e.value}));return r.filter((function(e){return!n.includes(e)})).length||r[0]===r[1]?r:[]}}]),i}(j),G={},R=(Math.max,Math.min);function B(e,t,n){var i,a,s,o,c,u,l=0,f=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function p(t){var n=i,r=a;return i=a=void 0,l=t,o=e.apply(r,n)}function g(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-l>=s}function v(){var e=Date.now();if(g(e))return m(e);c=setTimeout(v,function(e){var n=t-(e-u);return d?R(n,s-(e-l)):n}(e))}function m(e){return c=void 0,h&&i?p(e):(i=a=void 0,o)}function y(){var e=Date.now(),n=g(e);if(i=arguments,a=this,u=e,n){if(void 0===c)return function(e){return l=e,c=setTimeout(v,t),f?p(e):o}(u);if(d)return c=setTimeout(v,t),p(u)}return void 0===c&&(c=setTimeout(v,t)),o}return t=Number(t)||0,"object"===r(n)&&(f=!!n.leading,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==c&&clearTimeout(c),l=0,i=u=a=c=void 0},y}var I=function(e){d(r,e);var n=v(r);function r(){var e;t(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return P(p(e=n.call.apply(n,[this].concat(a))),"loadContent",B((function(t){e.emit("refresh"),e.loading(!0,t),e.xhr=new XMLHttpRequest,e.xhr.onload=function(n){return e.onLoad(n,t)},e.xhr.open("POST",e.getEndPoint(t)),e.xhr.send(e.formData(t))}),150,{leading:!0})),e}return s(r,[{key:"isLoadingMore",value:function(){return this.hasParams(this.loadMoreSlug)}},{key:"isLoadingPage",value:function(){return this.hasParams(this.loadPageSlug)}},{key:"pushState",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"push";if(this.history){"scrollRestoration"in history&&(window.history.scrollRestoration="manual"),e=""!==(e=this.getQueryString())?"?"+e:"",e+=window.location.hash;try{window.history["".concat(t,"State")]({WP_Grid_Builder:this.options.id},null,window.location.pathname+e)}catch(e){}}}},{key:"formData",value:function(e){var t=new FormData,n=this.getSettings();return this.emit("fetch",[n,e]),t.append("wpgb",JSON.stringify(n)),t}},{key:"getEndPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"render",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=t&&this.getQueryString(),(this.options.ajaxUrl||wpgb_settings.ajaxUrl).replace("wpgb-ajax=action","wpgb-ajax="+e)+(t?"&"+t:"")}},{key:"getSettings",value:function(){var e=window.wpgb_preview_settings||{},t=window.wpgb_settings||{},n=Object.keys(this.facets);return e.is_main_query=this.options.isMainQuery,e.main_query=t.mainQuery,e.permalink=t.permalink,e.facets=n.map(Number),e.lang=t.lang,e.id=this.options.id,this.options.isShadow&&(e.is_shadow=this.options.isShadow),this.options.isGutenberg&&(e.is_gutenberg=!0),this.options.isPreview&&(e.is_preview=!0),this.options.isTemplate&&(e.is_template=this.options.isTemplate,e.source_type=this.options.sourceType,e.query_args=this.options.queryArgs,e.render_callback=this.options.renderCallback,e.noresults_callback=this.options.noresultsCallback),this.options.postId&&(e.post_id=this.options.postId),e}},{key:"fetch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"refresh";this.abort(),this.loadContent(e)}},{key:"abort",value:function(){this.xhr&&this.xhr.abort(),delete this.xhr}},{key:"loading",value:function(e,t){var n=this.facets;if(("add"!==(e=e?"add":"remove")||"render"!==t&&!this.isLoadingMore())&&(!this.options.isShadow&&this.element.classList[e]("wpgb-loading"),"add"!==e||!this.isLoadingPage()))for(var r in n){var i=n[r];["pagination","load_more","search"].includes(i.type)||i.forEach((function(t){return t.holder.classList[e]("wpgb-loading")}))}}},{key:"onLoad",value:function(e,t){var n=this.getResponse(e.target.responseText),r=n.facets,i=n.posts,a=n.total,s=this.isLoadingMore()?"append":"replace";this.loading(),this.render(r),this.emit("loaded",[this.facets]),"refresh"===t?(this.appendItems(i,s),this.annonceResults(a)):(this.preFilter(),this.emit("prefilter")),G[this.element.facetGUID]=this.getQueryString()}},{key:"getResponse",value:function(e){var t={};try{t=JSON.parse(e)}catch(r){var n=e.match(/\{"(facets|posts)".*\}/i);if(n&&n[0])try{t=JSON.parse(n[0])}catch(e){console.error(e),t={}}else console.error("No valid content was detected in the response.")}return this.emit("fetched",[t]),t}},{key:"annonceResults",value:function(e){if(!this.isLoadingPage()&&!this.isLoadingMore()){var t,n=document.createElement("div"),r=wpgb_settings.resultMsg;void 0!==e&&r&&(t=null==r?void 0:r.plural,1===parseInt(e)?t=r.singular:parseInt(e)||(t=r.none),n.classList.add("wpgb-sr-only"),n.setAttribute("role","status"),n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic",!0),document.body.appendChild(n),setTimeout((function(){return n.textContent=t.replace("%d",e)}),100),setTimeout((function(){return document.body.removeChild(n)}),1e3))}}},{key:"appendItems",value:function(e,t){if(e){var n=document.createRange().createContextualFragment(e);if(this.options.isTemplate)this.appendTemplate(n,e,t);else if((e=n.querySelectorAll(".wpgb-card")).length){var r=this.element.querySelector(".wpgb-viewport > div");r&&(r.appendChild(n),this.emit("appended",[e,t]))}}}},{key:"appendTemplate",value:function(e,t,n){var r=this.options.itemSelector,i=this.element;if(t=r?e.querySelectorAll(r):b(e.children),r&&"append"===n||this.options.customContent){var a=i.querySelector(r);e=document.createDocumentFragment(),t.forEach((function(t){return e.appendChild(t)})),a&&(i=a.parentElement)}if("replace"===n)for(;i.firstChild;){var s=i.firstChild;i.removeChild(s),s=null}i.appendChild(e),this.emit("appended",[t,n])}}]),r}(D),F="_",T=function(e){d(r,e);var n=v(r);function r(){return t(this,r),n.apply(this,arguments)}return s(r,[{key:"getURLParams",value:function(){var e=window.location.search.slice(1);if(this.params=new URLSearchParams(e),!this.history){var t=this.params.get("s");this.params=new URLSearchParams(""),t&&this.params.set("s",t)}}},{key:"getParams",value:function(e){var t,n={},r=C(this.params.entries());try{for(r.s();!(t=r.n()).done;){var i=t.value,a=i[0].substring(1),s=i[1].split(",");if(i[0].charAt(0)===F){if(e===a)return s;n[a]=s}}}catch(e){r.e(e)}finally{r.f()}return e?[]:n}},{key:"getParam",value:function(e){return(this.params.get(F+e)||"").split(",")}},{key:"hasParams",value:function(e){return e&&this.params.has(F+e)}},{key:"setParams",value:function(e,t){t=(t=this.validateParams(t)).filter((function(e,t,n){return n.indexOf(e)===t})),this.updateParams(e,t)}},{key:"deleteParams",value:function(e,t){(t=this.validateParams(t)).length&&(t=this.getParam(e).filter((function(e){return t.indexOf(e)<0}))),this.updateParams(e,t)}},{key:"diffParams",value:function(e,t){var n=this.getParam(e);(t=this.validateParams(t)).forEach((function(e){var t=n.indexOf(e);-1===t?n.push(e):n.splice(t,1)})),this.updateParams(e,n)}},{key:"updateParams",value:function(e,t){e=F+e,(t=t.filter((function(e){return e.trim().length})))&&t.length?this.params.set(e,t.join(",")):this.params.delete(e)}},{key:"validateParams",value:function(e){return Array.isArray(e)?(e=e.filter((function(e){return"string"==typeof e||"number"==typeof e&&!isNaN(e)}))).map(String):[]}},{key:"getQueryString",value:function(){return this.params.toString()}}]),r}(I),W=function(e){d(r,e);var n=v(r);function r(){return t(this,r),n.apply(this,arguments)}return s(r,[{key:"query",value:function(){var e=this,t='.wpgb-facet[data-grid="'.concat(CSS.escape(this.options.id),'"]'),n=document.querySelectorAll(t);this.facets={},n.forEach((function(t){var n=parseInt(t.dataset.facet,10),r=t.closest(".wp-grid-builder");n<1||r&&r!==e.element||(e.facets.hasOwnProperty(n)||(e.facets[n]=[]),e.facet={id:n,init:!0,holder:t},e.facets[n].push(e.facet),WP_Grid_Builder.emit("prerender",[t,e.facet,e]))})),delete this.facet}},{key:"preFilter",value:function(){var e=this.facets;if(!this.getQueryString()){for(var t in e){var n=e[t][0],r=n.selected;r&&r.length&&this.setParams(n.slug,r)}this.pushState("replace")}}},{key:"getFacet",value:function(e){var t=this.facets,n=[];if(!Object.keys(t).length)return{};if(!e)return t;if(!isNaN(parseFloat(e))&&isFinite(e))return t.hasOwnProperty(e)&&(n=t[e]),n;for(var r in t)if(t.hasOwnProperty(r)&&t[r][0].slug===e)return t[r];return n}},{key:"hasFacet",value:function(e){return!!e&&!!this.getFacet(e).length}},{key:"render",value:function(e){var t=this;this.setFocused();var n=function(n){if(!e.hasOwnProperty(n)||!t.facets.hasOwnProperty(n))return 1;t.facets[n].forEach((function(r,i){t.facet=Object.assign(r,e[n]),t.facet.html&&t.facet.rendered||(t.facet.holder.classList.add("wpgb-notransitions"),t.remove(t.facet.holder),t.append(t.facet.holder),requestAnimationFrame((function(){return t.getFacet(n)[i].holder.classList.remove("wpgb-notransitions")}))),"reset"===t.facet.type&&(t.facet.rendered=!!t.facet.html),t.emit("render",[t.facet.holder,t.facet]),delete t.facet.focused,t.facets[n][i]=t.facet,t.initLoader()}))};for(var r in e)n(r);delete this.facet}},{key:"setFocused",value:function(){var e=document.activeElement;this.isFacet(e)&&(this.facet.focused=e)}},{key:"remove",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"append",value:function(e){var t=document.createRange().createContextualFragment(this.facet.html);e.appendChild(t)}},{key:"initLoader",value:function(){var e=this.facet,t=e.type,n=e.settings,r=e.holder,i=this.options.layout;"load_more"===t&&(this.loader=r.querySelector(".wpgb-load-more"),this.loader&&!wpgb_settings.renderBlocks&&"onscroll"===n.load_more_event&&(this.loader.onScroll=!0,"horizontal"!==i&&(this.unObserve(),this.observe())))}}]),r}(T),M=function(e){d(r,e);var n=v(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,r),(i=n.call(this)).options=a,i.element=e,i.autoRefresh=!0,i.query(),Object.keys(i.facets).length?(i.setInstance(),i.canPush(),i):g(i)}return s(r,[{key:"setInstance",value:function(){this.element.facetGUID||(this.facetGUID=Object.keys(G).length+1,this.element.facetGUID=this.facetGUID)}},{key:"init",value:function(){var e=this.element.facetGUID;if(G[e]){var t=G[e].toString();this.params=new URLSearchParams(t)}else this.getURLParams(),this.getQueryString()&&this.pushState("replace");Object.keys(this.facets).length&&(this.bindEvents(),this.emit("init",[this.facets]),this.fetch("render"))}},{key:"destroy",value:function(){this.abort(),this.unObserve(),this.bindEvents(!1),this.loading(!1),delete this.loader,delete this.loadMoreSlug,delete this.loadPageSlug}},{key:"canPush",value:function(){this.history=window.wpgb_settings&&wpgb_settings.history}},{key:"refresh",value:function(){this.autoRefresh&&(this.unsetLoaders(),this.pushState(),this.fetch())}},{key:"reset",value:function(e){var t=this,n=this.getQueryString();n&&(e||(e=(e=Object.keys(this.facets)).map((function(e){return t.facets[e][0]&&t.facets[e][0].slug}))),"string"==typeof e&&(e=[e]),e.forEach((function(e){return t.deleteParams(e)})),n!==this.getQueryString()&&(this.emit("reset",[e]),this.unsetLoaders(),this.pushState(),this.fetch()))}},{key:"unsetLoaders",value:function(){var e=this,t=["pagination","load_more"],n=this.facets;(n=Object.keys(n).map((function(e){var r=n[e][0];return r&&t.includes(r.type)&&r.slug}))).forEach((function(t){return t&&e.deleteParams(t)}))}},{key:"loadMore",value:function(){if(!this.xhr||4===this.xhr.readyState){var e=this.facet,t=e.slug,n=e.settings,r=e.holder.querySelector(".wpgb-load-more"),i=(r&&r.getBoundingClientRect()).width;if(r){r.classList.add("wpgb-loading"),n.loading_text&&(r.style.minWidth="".concat(i,"px"),r.textContent=n.loading_text);var a=(n.number+n.offset).toString();this.loadMoreSlug=t,this.deleteParams(this.loadPageSlug),this.setParams(t,[a]),this.emit("change",[t,[a]]),this.fetch()}}}},{key:"loadPage",value:function(e){var t=this.facet.slug;this.getParam(t)[0]!==(e=e<2?"":e)&&(this.loadPageSlug=t,this.deleteParams(this.loadMoreSlug),this.setParams(t,[e]),this.emit("change",[t,[e]]),this.pushState(),this.fetch())}}]),r}(W),N=M,U="undefined"!=typeof Map&&new Map,J={};function Q(e){return U.has(e.instance)}function H(e,t){e.instance=function(e){return J[e.type]||(J[e.type]=0),"".concat(e.type,"-").concat(++J[e.type])}(e),U.set(e.instance,t)}function V(e){return U.get(e.instance)}function X(e){U.delete(e.instance)}function Y(e){"date"===this.facet.type&&(this.facet.html?z.apply(this,[e,this.facet]):K.apply(this,[e,this.facet]))}function z(e,t){e.querySelector(".wpgb-date-facet")&&(t.rendered?Z(e,t):$.apply(this,[e,t]),t.rendered=!0)}function $(e,t){var n=this;WP_Grid_Builder.Date((function(r){var i=n.getFacet(t.id),a=e.querySelector("input.wpgb-input"),s=document.activeElement===a;i.length&&a?(t.selected=i[0].selected||t.selected,t.settings.locale=t.settings.locale.substring(0,2),t.settings.locale="ca"===t.settings.locale?"cat":t.settings.locale,n.emit("date.options",[t.settings,t]),r=r(a,t.settings),s&&r._input&&r._input.focus(),H(t,r),function(e,t){var n=e.querySelector(".wpgb-clear-button"),r=e.querySelector("input"),i=V(t),a=i.config.mode,s="";i.config.onOpen.push((function(){return s=i.selectedDates})),i.config.onClose.push((function(){if("range"===a&&1===i.selectedDates.length){var e=s.map((function(e){return i.formatDate(e,"Y-m-d")}));requestAnimationFrame((function(){return i.setDate(e)}))}})),r.addEventListener("change",(function(e){if("range"===a&&1===i.selectedDates.length)return e.preventDefault(),void e.stopPropagation();var t=i.selectedDates.map((function(e){return i.formatDate(e,"Y-m-d")}));t=t.filter((function(e,t,n){return n.indexOf(e)===t})),r.value="range"===a?t.length?t:"":t.length?t[0]:"",n.hidden=!t.length})),n&&n.addEventListener("click",(function(e){e.preventDefault(),i.clear(),i.altInput.focus(),i.close()}))}(e,t),Z(e,t),n.emit("date.init",[r,t])):K.apply(n,[e,t])}))}function K(e,t){Q(t)&&(V(t).destroy(),X(t),this.emit("date.destroy",[t])),t.rendered=!1}function Z(e,t){if(Q(t)){var n=t.selected,r=e.querySelector(".wpgb-clear-button"),i=V(t);t.settings.minDate&&(i.set("minDate",[t.settings.minDate].concat(b(n)).reduce((function(e,t){return e<t?e:t}))),i.set("maxDate",[t.settings.maxDate].concat(b(n)).reduce((function(e,t){return e>t?e:t}))));var a=new Date,s=i.config.minDate||a,o=i.config.maxDate||a;i.setDate(n),n&&n[0]?i.jumpToDate(n[0]):a>=new Date(s)&&a<=new Date(o)?i.jumpToDate(a):a<new Date(s)?i.jumpToDate(s):a>new Date(o)&&i.jumpToDate(o),r&&(r.hidden=!(n&&n.length))}}function ee(e){"range"===this.facet.type&&(this.facet.html?te.apply(this,[e,this.facet]):re.apply(this,[e,this.facet]))}function te(e,t){e.querySelector(".wpgb-range-facet")&&(t.rendered?function(e,t){var n=V(t),r=document.createRange().createContextualFragment(t.html),i=r.querySelectorAll(".wpgb-range-facet input"),a=e.querySelectorAll(".wpgb-range-facet input"),s=["step","min","max","value"];if(a.length&&i.forEach((function(e,t){return s.forEach((function(e){return a[t][e]=i[t][e]}))})),!n)return;n.previous=[n.inputs[0].value,n.inputs[1].value],n.setValues(),n.getSliderSize(),n.updateSlider()}(e,t):ne.apply(this,[e,t]),t.rendered=!0)}function ne(e,t){var n=this;WP_Grid_Builder.Range((function(r){var i=n.getFacet(t.id),a=e.querySelector(".wpgb-range-facet"),s=e.querySelector(".wpgb-range-facet-loader"),o=wpgb_settings.range;i.length&&a?(t.selected=i[0].selected||t.selected,t.settings.minLabel=o?o.minLabel:"",t.settings.maxLabel=o?o.maxLabel:"",n.emit("range.options",[t.settings,t]),r=r(a,t.settings),H(t,r),s&&s.parentElement.removeChild(s),n.emit("range.init",[r,t])):re.apply(n,[e,n.facet])}))}function re(e,t){Q(t)&&(V(t).destroy(),X(t),this.emit("range.destroy",[t])),t.rendered=!1}function ie(e){"number"===this.facet.type&&(this.facet.html?(ae.apply(this,[e,this.facet]),this.facet.rendered=!0):this.facet.rendered=!1)}function ae(e,t){var n=this,r=e.querySelectorAll('input[type="number"]');if(r.length){var i=e.querySelector("button.wpgb-number-submit");if(ce.apply(this,[r,t]),i&&se.apply(this,[t,r,i]),!t.rendered){if(i)return se.apply(this,[t,r,i]),i.addEventListener("click",(function(e){return ue.apply(n,[e,t,r])})),r.forEach((function(e){return e.addEventListener("change",(function(e){return e.stopPropagation()}))})),r.forEach((function(e){return e.addEventListener("input",B((function(){return se.apply(n,[t,r,i])}),50))})),void r.forEach((function(e){return e.addEventListener("keydown",(function(e){return"Enter"===e.key&&ue.apply(n,[e,t,r])}))}));r.forEach((function(e){return e.addEventListener("change",(function(e){return ue.apply(n,[e,t,r])}))})),r.forEach((function(e,i){e.addEventListener("input",(function(){return oe.apply(n,[event,t,i])})),e.addEventListener("input",B((function(e){return ue.apply(n,[e,t,r])}),350))}))}}}function se(e,t,n){var r=this.getParams(e.slug),i=le(t);n.disabled=fe(i,r)}function oe(e,t,n){this.getParams(t.slug)[n]!==e.target.value.trim()&&this.abort()}function ce(e,t){var n=document.createRange().createContextualFragment(t.html).querySelectorAll('input[type="number"]');e.forEach((function(e,r){e.min=t.settings.min,e.max=t.settings.max,e.step=t.settings.step,e.value=n[r].value,e.placeholder=n[r].placeholder}))}function ue(e,t,n){var r=le(n),i=this.getParams(t.slug);e.stopPropagation(),fe(r,i)||(this.updateParams(t.slug,r.map((function(e){return e.toString()}))),this.emit("change",[t.slug,r]),this.refresh())}function le(e){var t=b(e).map((function(e){return e.value||"_"}));return t.filter((function(e){return"_"!==e})).length||(t=[]),t}function fe(e,t){return!e.length&&!t.length||e.length===t.length&&(1===e.length&&e[0]===t[0]||2===e.length&&e[0]===t[0]&&e[1]===t[1])}window.WP_Grid_Builder.on("prerender",(function(e,t,n){e.querySelector(".wpgb-date-facet")&&WP_Grid_Builder.Date()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",Y)})),window.WP_Grid_Builder.on("prerender",(function(e,t,n){e.querySelector(".wpgb-range-facet")&&WP_Grid_Builder.Range()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",ee)})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",ie)}));n(594);var de="undefined"!=typeof Map&&new Map;function he(e){var t=e.target;"LI"===t.tagName&&t.hasAttribute("tabindex")&&(this.querySelectorAll('li[tabindex="0"]').forEach((function(e){return e.tabIndex=-1})),t.tabIndex=0)}function pe(e){var t=e.target;if("treeitem"===t.getAttribute("role")){var n=de.get(this),r=t.getAttribute("aria-expanded");ve(n,t,"false"===r),we(t)}}function ge(e){var t=e.target.closest("li");if(t){var n=de.get(this);switch(e.key){case" ":case"Enter":!function(e){var t=e.querySelector('.wpgb-checkbox[role=button]:not([tabindex="-1"])');t&&t.click()}(t);break;case"*":case"Multiply":!function(e,t){var n=t.closest("ul").children;b(n).forEach((function(t){return ve(e,t,!0)}))}(n,t);break;case"Home":!function(e){var t=e.items[0];!we(t)&&me(e,t)}(n);break;case"End":!function(e){var t=e.items[e.items.length-1];!we(t)&&ye(e,t)}(n);break;case"Left":case"ArrowLeft":"true"===t.getAttribute("aria-expanded")?ve(n,t,!1):ye(n,t,!0);break;case"Right":case"ArrowRight":"true"===t.getAttribute("aria-expanded")?me(n,t,!0):ve(n,t,!0);break;case"Down":case"ArrowDown":me(n,t);break;case"Up":case"ArrowUp":ye(n,t);break;default:return void function(e,t,n){for(var r=e.items,i=r.length,a=b(r).indexOf(t),s=a+1;s<i;s++)if(be(r[s],n)&&we(r[s]))return;for(var o=0;o<a;o++)if(be(r[o],n)&&we(r[o]))return}(n,t,e.key)}e.preventDefault()}}function ve(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.hasAttribute("aria-expanded")&&(r||null!==t.offsetParent)){var i=t.closest(".wpgb-facet"),a=t.querySelector("input");t.setAttribute("aria-expanded",n),n?e.states[a.value]=!0:delete e.states[a.value],de.set(i,e)}}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.items,i=r.length,a=b(r).indexOf(t),s=n&&t.querySelector("ul");if(!(a>=i-1))for(var o=a+1;o<i&&(n&&s!==r[o].parentElement||!we(r[o]));o++);}function ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.items,i=b(r).indexOf(t);if(!(i<1))for(var a=i-1;a>=0&&(n&&!r[a].contains(t)||!we(r[a]));a--);}function be(e,t){return e.textContent.charAt(0).toLowerCase()===t}function we(e){return!!Se(e)&&(e.focus(),!0)}function Se(e){return null!==e.offsetParent&&!e.querySelector("input").disabled}function _e(e){var t=e.target,n=t.closest(".wpgb-checkbox"),r=n&&n.closest('li[role="treeitem"][aria-expanded="false"]');Pe.call(this,t),Ee.call(this,n),n&&n.closest("li").querySelector('[aria-pressed="true"]')&&"false"===n.getAttribute("aria-pressed")&&n.setAttribute("aria-pressed","mixed"),r&&"true"===n.getAttribute("aria-pressed")&&r.click()}function Pe(e){for(;e=xe(e);){var t=Ae(e),n=n||b(t).filter((function(e){return"true"===e.getAttribute("aria-pressed")})).length,r=e.getAttribute("aria-pressed");n&&"false"===r&&e.setAttribute("aria-pressed","mixed"),!n&&"mixed"===r&&e.setAttribute("aria-pressed","false"),n&&ke.call(this,e)}}function ke(e){var t=e.querySelector("input"),n=t.name,r=t.value;e.setAttribute("aria-pressed","mixed"),this.deleteParams(n.replace("[]",""),[r])}function Ee(e){var t=this;Ae(e).forEach((function(e){var n=e.querySelector("input"),r=n.name,i=n.value;e.setAttribute("aria-pressed","false"),t.deleteParams(r.replace("[]",""),[i])}))}function xe(e){return(e=(e=e.closest("ul"))&&e.closest("li"))&&e.querySelector(".wpgb-checkbox")}function Ae(e){return(e=(e=e.closest("li"))&&e.querySelector("ul"))&&e.querySelectorAll(".wpgb-checkbox")||[]}function qe(e){"search"===this.facet.type&&(this.facet.html?(Le.apply(this,[e,this.facet]),this.facet.rendered=!0):this.facet.rendered=!1)}function Le(e,t){var n=this,r=e.querySelector('input[type="search"]');r&&(t.rendered||je.call(this,r,t),function(e,t){var n=e.value.trim(),r=t.selected.join(),i=De(t);n!==r&&(e.value=r);i&&(i.hidden=!r.length)}(r,t),t.settings.instant_search&&!t.rendered&&(r.addEventListener("input",(function(){return Oe.apply(n,[event,t])})),r.addEventListener("input",B((function(e){return Ce.apply(n,[e,t])}),350)),r.addEventListener("change",(function(e){return e.stopPropagation()}))))}function Oe(e,t){this.getParams(t.slug).join().trim()!==e.target.value.trim()&&this.abort()}function Ce(e,t){var n=this.getParams(t.slug).join().trim(),r=e.target.value.trim();n!==r?(this.setParams(t.slug,[r]),this.emit("change",[t.slug,r?[r]:[]]),this.refresh()):e.stopPropagation()}function je(e,t){var n=this,r=De(t);r&&(e.addEventListener("input",(function(){return r.hidden=!e.value.length})),r.addEventListener("mousedown",(function(e){return e.preventDefault()})),r.addEventListener("click",(function(){e.value="",r.hidden=!0,e.focus(),Ce.call(n,event,t)})))}function De(e){return e.holder.querySelector(".wpgb-clear-button")}function Ge(e){"sort"!==this.facet.type&&"select"!==this.facet.type&&"per_page"!==this.facet.type||(this.facet.html?Re.apply(this,[e,this.facet]):Ie.apply(this,[e,this.facet]))}function Re(e,t){e.querySelector("select.wpgb-combobox")&&(t.rendered?function(e,t){var n=t.settings,r=t.html,i=V(t),a=i?i.element:e.querySelector("select.wpgb-select"),s=document.createRange().createContextualFragment(r).querySelectorAll("select option"),o=[];Array.from(a.options).forEach((function(e){return a.remove(e)})),s.forEach((function(e,t){e.selected&&o.push(e.value),a.add(e,t)})),a.multiple||(a.value=o[0]||"");i&&(!n.async&&i.Data.parse(),n.async&&i.close(),i.DOM.clearDropDown(),requestAnimationFrame((function(){return i.update()})))}(e,t):Be.apply(this,[e,t]),t.rendered=!0)}function Be(e,t){var n=this;WP_Grid_Builder.Select((function(r){var i=n.getFacet(t.id),a=e.querySelector("select.wpgb-combobox");i.length&&a?(t.selected=i[0].selected||t.selected,n.emit("select.options",[t.settings,t]),(r=r(a,Fe.apply(n,[e,t]))).init(),H(t,r),n.emit("select.init",[r,t])):Ie.apply(n,[e,n.facet])}))}function Ie(e,t){Q(t)&&(V(t).destroy(),X(t),this.emit("select.destroy",[t])),t.rendered=!1}function Fe(e,t){var n=this,r={messages:E({},wpgb_settings.combobox)};if(!t||!t.settings)return r;if(r.messages.noResults=t.settings.no_results,r.messages.loading=t.settings.loading,r.messages.search=t.settings.search,r.searchable=t.settings.searchable,r.clearable=t.settings.clearable,r.clearLabel=r.messages.clearLabel,t.settings.async){var i=this.getEndPoint("search",!1).split(/[?#]/);r.async={url:i[0],data:function(){var e,t=n.getParams(),r={},a=C((i[1]&&new URLSearchParams(i[1])).entries());try{for(a.s();!(e=a.n()).done;){var s=e.value;r[s[0]]=s[1].split(",")}}catch(e){a.e(e)}finally{a.f()}for(var o in t)r["_"+o]=t[o];return r},post:function(t){var r=new FormData,i=n.getSettings();return i.search={facet:Number(e.getAttribute("data-facet")),string:t},r.append("wpgb",JSON.stringify(i)),r},response:function(e){var t=[];return e.length&&e.forEach((function(e){var n=!1!==e.count?" ("+e.count+")":"";t.push({value:e.facet_value,textContent:e.facet_name+n,disabled:e.disabled})})),t}}}return r}window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",(function(e){if("checkbox"===this.facet.type&&this.facet.settings.treeview){var t=de.has(e),n=de.get(e)||{states:{}},r=e.querySelectorAll(".wpgb-checkbox-facet li");if(function(e,t){for(var n in t){var r=e.querySelector('li[role=treeitem] input[value="'.concat(n,'"]'));r&&r.closest("li").setAttribute("aria-expanded",!0)}}(e,n.states),de.set(e,E(E({},n),{items:r})),t||(e.addEventListener("click",pe),e.addEventListener("keydown",ge),e.addEventListener("focus",he,!0),function(e,t){var n=e.selected,r=e.holder;n.forEach((function(e){var n=r.querySelector('input[value="'.concat(e,'"]')),i=n.closest("li[role=treeitem][aria-expanded=false]");for(i&&(i.setAttribute("aria-expanded",!0),t.states[i.querySelector("input").value]=!0),n=n&&n.closest("ul");n;)(n=n.closest("li[role=treeitem][aria-expanded=false]"))&&(n.setAttribute("aria-expanded",!0),t.states[n.querySelector("input").value]=!0)})),de.set(r,E(E({},t),{states:t.states}))}(this.facet,de.get(e))),this.facet.focused){var i=this.facet.focused.querySelector("input");if(i){var a=e.querySelector('[role="button"] input[type="hidden"][value="'.concat(i.value,'"]')),s=a&&a.closest('[role="button"]');if(s)return void s.closest("li").focus({preventScroll:!0})}}for(var o=0;o<r.length;o++)if(Se(r[o])){r[o].tabIndex=0;break}}})),e.facets.on("toggle",(function(e,t){"checkbox"===e.type&&e.settings.treeview&&!t&&function(e){var t=e.holder,n=t.querySelector('li[tabindex="0"][hidden], li[hidden] li[tabindex="0"]'),r=de.get(t);if(r.items&&r.items.forEach((function(e){return null===e.offsetParent&&ve(r,e,!1,!0)})),r&&n)for(var i=r.items,a=b(i).indexOf(n)-1;a>=0;a--)if(Se(i[a])){i[a].tabIndex=0,n.tabIndex=-1;break}}(e)}))})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",(function(e){"checkbox"===this.facet.type&&this.facet.settings.hierarchical&&(!function(e){e.forEach((function(e){for(;e=xe(e);)"false"===e.getAttribute("aria-pressed")&&e.setAttribute("aria-pressed","mixed")}))}(e.querySelectorAll('.wpgb-checkbox[aria-pressed="true"]')),!e._onChange&&e.addEventListener("change",_e.bind(this)),e._onChange=!0)}))})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",qe)})),window.WP_Grid_Builder.on("prerender",(function(e,t,n){e.querySelector("select.wpgb-combobox")&&WP_Grid_Builder.Select()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",Ge)}));n(378);function Te(e){var t=this;if("apply"===this.facet.type){var n=this.options.isShadow,r=this.facet,i=r.settings,a=r.slug,s=i.apply_redirect,o=i.apply_history,c=this.facet.html&&e.querySelector("button.wpgb-apply");this.facet.rendered||c&&c.addEventListener("click",(function(){return Xe.apply(t,[a])})),s&&n||(this.appliedParams=this.getParams()),this.autoRefresh=s&&n&&this.autoRefresh,this.history=this.history&&(!n||o),this.facet.rendered=!0,this.facet.html?($e.call(this,c),Ke.call(this,c)):this.facet.rendered=!1}}function We(){"appliedParams"in this&&(this.appliedParams=this.getParams())}function Me(e,t){if("appliedParams"in this){var n=this.getFacet(e)[0],r=n&&n.id,i=this.facet&&this.facet.type||n&&n.type;this.autoRefresh=!1,["sort","reset","selection","pagination","load_more","per_page"].includes(i)||Qe.call(this).includes(r)?(this.autoRefresh=!0,this.appliedParams[e]=t,Ve.call(this,e)):He.call(this)}}function Ne(){"appliedParams"in this&&(this.appliedParams=this.getParams())}function Ue(e){var t=this;"appliedParams"in this&&(e.forEach((function(e){return delete t.appliedParams[e]})),Ve.call(this,""))}function Je(){var e=[];for(var t in this.facets)this.facets[t].forEach((function(t){return"apply"===t.type&&e.push(t)}));return e}function Qe(){var e=[];return Je.call(this).forEach((function(t){e=[].concat(b(e),b(t.settings.apply_excluded||[]))})),e.map(Number)}function He(){var e=this;Je.call(this).forEach((function(t){return Ke.call(e,t.holder.querySelector("button.wpgb-apply"))}))}function Ve(e){for(var t in this.getParams())!this.appliedParams[t]&&this.setParams(t,[]);for(var n in this.appliedParams)n!==e&&this.setParams(n,this.appliedParams[n])}function Xe(e){var t=this.getFacet(e)[0];t&&t.settings.apply_redirect?Ye.apply(this,[e]):ze.apply(this,[e])}function Ye(e){var t=this.getQueryString(),n=this.getFacet(e)[0];if(!this.options.isGutenberg&&n&&n.settings.apply_url){var r=n.settings.apply_url.includes("?")?"&":"?";window.location.href=n.settings.apply_url+(t?r+t:"")}}function ze(e){this.emit("apply",[e]),this.appliedParams=this.getParams(),this.autoRefresh=!0,this.refresh()}function $e(e){var t=this.facet.html&&document.createRange().createContextualFragment(this.facet.html),n=t&&t.querySelector("button.wpgb-apply");n&&e&&(e.textContent=n.textContent)}function Ke(e){"appliedParams"in this&&e&&(e.disabled=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e){if(!t[n])return!1;if(JSON.stringify(b(e[n]).sort())!==JSON.stringify(b(t[n]).sort()))return!1}return!0}(this.appliedParams||{},this.getParams()))}window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",Te),e.facets.on("prefilter",We),e.facets.on("change",Me),e.facets.on("refresh",Ne),e.facets.on("reset",Ue)}));var Ze="undefined"!=typeof Map&&new Map;function et(e){"autocomplete"===this.facet.type&&(this.facet.html?tt.apply(this,[e,this.facet]):at.apply(this,[e,this.facet]))}function tt(e,t){t.rendered?function(e,t){var n=e.querySelector('input[type="search"]');if(!n)return;n.value=t.selected.join(),it(t)}(e,t):nt.apply(this,[e,t]),t.rendered=!0}function nt(e,t){var n=this;WP_Grid_Builder.AutoComplete((function(r){var i=n.getFacet(t.id),a=e.querySelector('input[type="search"]');if(i.length&&a){var s=st.apply(n,[e,t]);t.selected=i[0].selected||t.selected,n.emit("autocomplete.options",[s,t]),r=r(a,s),H(t,r),n.emit("autocomplete.init",[r,t]),a.addEventListener("change",(function(e){return e.stopPropagation()})),a.addEventListener("keydown",(function(e){var r=e.key,i=n.getParams(t.slug).join();"Enter"===r&&i!==a.value&&(rt.call(n,t.slug,a.value),it(t))}))}else at.apply(n,[e,n.facet])}))}function rt(e,t){this.getParams(e).join()!==t&&(this.setParams(e,[t]),this.emit("change",[e,[t]]),this.refresh())}function it(e){if(Q(e)){var t=V(e);t.abort(),t.update(),t.close()}}function at(e,t){Q(t)&&(V(t).destroy(),X(t),this.emit("autocomplete.destroy",[t])),t.rendered=!1}function st(e,t){var n,r=this,i=t.settings;return{loader:!0,messages:wpgb_settings.autocomplete,minLength:i.acplt_min_length,matchAll:i.acplt_match_all,autoFocus:i.acplt_auto_focus,clearLabel:wpgb_settings.autocomplete.clearLabel,highlighter:!!i.acplt_highlight&&document.createElement("mark"),filterResults:function(){return!0},sortResults:!!i.acplt_relevance&&function(e,t){return e.disabled-t.disabled||e.index-t.index||e.label.localeCompare(t.label)||e.label.length-t.label.length},source:function(e,i){e=e.trim();var a=r.getEndPoint("search"),s=r.getSettings(),o=function(e,t,n){var r=new FormData;return n.search={facet:t.id,string:e},r.append("wpgb",JSON.stringify(n)),r}(e,t,s),c=function(e,t,n,r){for(var i in e.params=t,e.params)i===n.slug?delete e.params[i]:e.params[i].sort();return e.search={facet:n.id,string:r},JSON.stringify(e)}(s,r.getParams(),t,e);n&&n.abort(),Ze.has(c)?i(Ze.get(c)):(n=new XMLHttpRequest,ot(a,o,c,n,i))},renderItem:function(e,t){if(e.disabled&&t.setAttribute("aria-disabled",!0),!1!==e.count){var n=" ("+e.count+")";"string"==typeof e.content?e.content+=n:e.content.append(document.createTextNode(n))}return e.content},onSelect:function(e){return rt.call(r,t.slug,e.label)},onClear:function(){return rt.call(r,t.slug,"")},onAbort:function(){n&&n.abort(),ot.cancel()}}}window.WP_Grid_Builder.on("prerender",(function(e,t,n){e.querySelector(".wpgb-autocomplete-facet")&&WP_Grid_Builder.AutoComplete()})),window.WP_Grid_Builder.on("init",(function(e){e.facets.on("render",et)}));var ot=B((function(e,t,n,r,i){r.onload=function(e){var t=e.target.responseText;try{t=JSON.parse(t)}catch(e){t=[]}t=t.map((function(e){return E(E({},e),{},{value:e.facet_name,label:e.facet_name})})),Ze.set(n,t),i(t)},r.open("POST",e),r.send(t)}),250);n(417);var ct,ut,lt,ft=0;WP_Grid_Builder.unsupported?(ct=document.querySelectorAll(".wpgb-facet"),ut=document.querySelectorAll(".wpgb-sidebar"),ct&&ct.forEach((function(e){var t=e.firstElementChild;t&&"wpgb-pagination-facet"!==t.className?e.style.display="none":e.classList.remove("wpgb-loading")})),ut&&ut.forEach((function(e){return e.parentElement.removeChild(e)}))):(lt=wpgb_settings.hasGrids,WP_Grid_Builder.Facets=function(e,t){return new N(e,t)},WP_Grid_Builder.Range=function(e,t){new l("wpgb-range",(function(){return e&&e(WP_Grid_Builder.vendors.range,t)}))},WP_Grid_Builder.Date=function(e,t){new l("wpgb-date-css"),new l("wpgb-date",(function(){return e&&e(WP_Grid_Builder.vendors.date,t)}))},WP_Grid_Builder.Select=function(e,t){new l("wpgb-select",(function(){return e&&e(WP_Grid_Builder.vendors.select,t)}))},WP_Grid_Builder.AutoComplete=function(e,t){new l("wpgb-autocomplete",(function(){return e&&e(WP_Grid_Builder.vendors.autocomplete,t)}))},lt?e("wpgb.facets.loaded"):(WP_Grid_Builder.instantiate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.instances[++ft]=new O(e,t)},function(e){if("complete"===document.readyState||"interactive"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e)}((function(){return e("wpgb.loaded")}))))}()}();